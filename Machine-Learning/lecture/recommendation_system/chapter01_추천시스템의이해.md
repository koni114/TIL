## chapter01 추천시스템 입문하기
### 추천시스템의 개요
- 추천시스템은 사용자(user)에게 상품(item)을 제안하는 소프트웨어 도구이자 기술
- 이러한 제안은 어떤 상품을 구매할 지, 어떤 음악을 들을지, 어떤 온라인 뉴스를 읽을지와 같은 다양한 의사결정과 연관이 있음
- 목표는 어떤 사용자에게 어떤 상품을 어떻게 추천할지에 대해 이해

### 기업에서의 추천시스템
- 당근마켓: 같이 본 상품
- 카카오(브런치) : 카카오에서의 추천 사례 -> 해당 글과 유사한 글을 추천

### 파레토의 롱테일의 법칙
- 파레토의 법칙: 상위 20%가 80%의 가치를 창출함
- 롱테일의 법칙: 하위 80%가 상위 20%의 가치보다 큼

### 추천시스템의 역사
- 2005 ~ 2010: Apriori 알고리즘. 연관상품추천
- 2010 ~ 2015: 협업 필터링. SVD, 2006~2009년 넷플릭스 추천대회
- 2013 ~ 2017: Spark를 이용한 빅데이터 - FP-Growth, Matrix Factorization
- 2015 ~ 2017: 딥러닝을 이용한 추천 시스템 : 협업필터링 + 딥러닝, Item2Vec, Doc2Vec 등
- 2017 ~ : 개인화 추천 시스템. Factorization Machine, Hirarchical RNN, 강화학습 + Re-Ranking, 딥러닝

### 연관분석(Association Analysis)
- 룰기반의 모델로서 상품과 상품사이의 어떤 연관이 있는지를 찾아내는 알고리즘
- 연관은 2가지 형태로 존재함

#### 연관의 정의
- 얼마나 같이 구매가 되는지?
- A아이템을 구매하는 사람이 B아이템을 함께 구매하는지? 장바구니 분석이라고도 함
- ex) 사람들이 맥주를 구매할 때, 기저귀를 같이 구매하려는 경향이 크다는 것을 밝힘

#### 규칙평가지표
- support(지지도) : A와 B를 모두 포함하는 거래 건수의 비율
- confidence(신뢰도) : A 상품을 구매했을 때, B 상품까지 구매가 이어질 확률
- lift(향상도) : 항목 A가 주어지지 않았을 때 B의 구매 비율 대비 A가 주어졌을 때 B의 구매 비율의 증가 비율

#### 규칙 생성
- 가능한 모든 경우의 수를 탐색해서 지지도, 신뢰도, 향상도가 높은 규칙들을 찾아내는 방식
- ex) 상품이 4개일 때, 상품을 구매할 수 있는 경우의 수는,  
  4C1 + 4C2 +  4C3 + 4C4 = 15가지의 경우가 나오며, 이 15가지의 경우에 대해서 각각 지지도, 신뢰도, 향상도가 높은 순으로 구하는 것
- 아이템의 증가에 따른 규칙의 수의 증가가 기하급수적으로 증가
- 이러한 문제를 해결하기 위하여 나온 알고리즘이 Apriori라고 하는 알고리즘임

#### Aprioi 
- Aprioi 원리는 아이템셋 증가를 줄이기 위한 방법
- 기본적인 아이디어는 빈번한 아이템셋은 하위 아이템셋 또한 빈번할 것이다! 임
- 즉, 빈번하지 않은 아이템셋은 하위 아이템셋 또한 빈번하지 않다를 이용해서 아이템셋의 증가를 줄이는 방법
- 예를들어 2번과 3번 아이템을 같이 구매할 때의 지지도는 1,2,3번 아이템을 같이 구매하는 경우나 2,3,4번 아이템을 같이 구매하는 경우의 지지도보다는 반드시 클 수 밖에 없는데, 만약 2번과 3번을 같이 구매하는 지지도의 값이 작다면, 뒤에 2가지 케이스도 같이 작을 것이므로 3개의 케이스를 함께 지워주겠다!라는 아이디어

#### Aprioi 알고리즘
- k개의 item을 가지고 단일항목집단 생성(1, 2, 3, 4 ...)
- 단일항목집단에서 최소 지지도 이상의 항목만 선택
- 2에서 선택된 항목만을 대상으로 2개항목집단 생성
- 2개항목집단에서 최소 지지도 혹은 신뢰도 이상의 항목만 선택
- 위의 과정을 k개의 k-item frequent set을 생성할 때까지 반복

#### Aprioi 알고리즘 - 데이터
~~~
거래번호   상품 목록
0        우유, 기저귀, 쥬스
1        양상추, 기저귀, 맥주 
2        우유, 양상추, 기저귀, 맥주
3        양상추, 맥주

거래번호   우유  양상추   기저귀   쥬스  맥주
0         1     0       1     1   0
1         0     1       1     0   1
2         1     1       1     0   1
3         0     1       0     0   1
~~~
- 위의 데이터는 보통 Implicit Feedback data라고 하는데, 그 이유는 해당 데이터는 고객이 만족했는지의 여부는 알 수 없기 때문에 implicit이라는 용어를 사용
- 또한 아래 데이터와 같이 matrix로 변형 했는데, 해당 데이터에는 0의 값이 많으므로 spare Matrix라고 부름
- 먼저 단일항목집단을 생성하고, 최소 지지도를 0.5라고 생각하고, 단일항목집단의 지지도를 계산해보자
  - P(우유): 0.5, P(양상추): 0.75, P(기저귀): 0.75, P(쥬스): 0.25(삭제), P(맥주): 0.75
  - 즉, 쥬스를 제외하고 4C2를 계산하고 단계를 계속적으로 진행해 나감
- 여기서는 support만을 고려했지만, confidence, lift도 같이 고려할 수 있음

#### Aprioi 알고리즘의 장점
- 원리가 간단하여 사용자가 쉽게 이해할 수 있고 의미를 파악할 수 있음
- 유의한 연관성을 갖는 구매패턴을 찾아줌

#### Aprioi 알고리즘의 단점
- 데이터가 클 경우, 속도가 느리고 연산량이 많음
- 실제 사용시에 많은 연관상품들이 나타나는 단점이 있음

### FP-Growth 알고리즘
- 위의 Aprioi 알고리즘의 성능을 개선하고 나온 알고리즘으로서, Tree 형태로 거래를 저장하여 값을 게산하는 방식 
- 먼저 모든 거래를 확인하여, 각 아이템마다의 support를 계산하고 최소 지지도이상의 아이템만 선택
- 모든 거래에서 빈도가 높은 아이템 순서대로 순서를 정렬
- 부모 노드를 중심으로 거래를 자식노드로 추가해주면서 tree를 생성
- 새로운 아이템이 나올 경우에는 부모노드부터 시작하고, 그렇지 않으면 기존의 노드에서 확장
- 지지도가 낮은 순서대로 시작하여 조건부 패턴을 생성

#### 장점
- Aprioi 알고리즘보다 빠르고 2번의 탐색만 필요로 함
- 후보 Itemsets을 생성할 필요없이 진행 가능

#### 단점
- 대용량의 데이터셋에서 메모리를 효율적으로 사용하지 않음
- Aprioi 알고리즘에 비해 설계하기 어려움
- 지지도의 계산이 FP-TREE가 만들어지고 나서야 가능

### 개인 추천화
- 처음에는 고객을 세분화로 나누고, 각 클러스터링 군에 따라서 다른 컨텐츠를 추천해 주어야 함