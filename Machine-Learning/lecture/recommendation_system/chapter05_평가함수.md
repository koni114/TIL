## chapter05 평가함수
### 평가함수를 다양하게 알아야 하는 이유
- 평가함수는 추천시스템의 모델을 생성하고 해당 모델이 얼마나 잘 추천하고 있는지에 대해 평가를 도와주는 함수
- 도메인이나 목적에 따라 다른 평가 함수를 도입해서 얼마나 잘 추천이 되는지 평가가 중요
- 예를들어, 영화평점의 경우 두가지 형태로 평가 가능
  - 내가 추천해준 영화를 고객이 봤나?
  - 내가 추천해준 영화를 고객이 높은 점수로 평점을 주었나?   
- 위의 2가지는 다름. 1번의 경우 단순히 보기만하면 추천에 성공했다고 하지만, 실제 고객의 만족도는 낮을 수 있음
- 반대로 2의 경우는 고객의 만족도까지 고려하여 평가를 한 것. 이러한 성질은 추천을 진행할때에도 차이가 생김
- 사실 단순히 매체를 클릭한 것이 중요한 것이 아니라, 얼마만큼 체류 했는지?를 고려하는 것도 중요

### Accuracy
- 내가 추천해준 영화를 고객이 보았는지 ? vs 보지 않았나?
- 내가 추천해주는 영화를 많이 볼수록, 추천하지 않은 영화를 보지 않을수록 정확도는 상승
- 추천하지 않은 영화의 수는 추천한 영화의 수에 비해 굉장히 많고 편향된 결과를 얻을 수 있음
- 추천해준 영화 중 본 영화로만 평가를 매겨야 함  

### MAP
- Precision의 average를 계산
- MAP의 경우 추천의 순서에 따라서 차이가 남. 또한 상위 k개의 추천에 대해서만 평가하기에 k를 바꿔가면서 상위 몇 개를 추천하는게 좋을지도 결정할 수 있음
- Recommendatons: 추천을 했는데 맞은 경우 1, 틀리면 0
- AP: Precision @k's를 평균낸 값(추천한 K개의 영화의 Precision을 평균)
- MAP@4: 4명의 사용자의 AP를 평균낸 값(Precision을 평균낸 Ap를 4명의 사용자에 대해 평균) 

~~~
Recommendation     Precision @k's     AP@3
[0, 0, 1]           [0, 0, 1/3]      (1/3) * (1/3) = 0.11
[0, 1, 1]           [0, 1/2, 2/3]    (1/3)[1/2 + 2/3] = 0.38
[1, 1, 0]           [1/1, 2/2, 2/3]  (1/3)[1/1 + 2/2 + 2/3] = 0.89 
[1, 1, 1]           [1/1, 2/2, 3/3]  (1/3)[1 + 2/2 + 3/3] = 1
~~~

### NDCG(Normalized Discounted Cumulative Fain)
- ranking quality measure, 검색 알고리즘에서 성과를 측정하는 평가 매트릭
- 사용자마다 추천 개수가 다를 수 있는데, 이를 정규화해 맞춰 준 지표함수
- 추천엔진은 user와 연관있는 documents의 집합을 추천해주기 때문에, 단순히 문서 검색 작업을 수행한다고 생각 할 수 있음(검색과 관련있는 문서들을 추천)
- 따라서 NDCG를 사용하여 추천엔진을 평가할 수 있음
- NDCG를 이해하기 위해서는 Cumulative Gain과 Discounted Cumulative Gain을 이해할 필요가 있음

#### CG(Cumulative Gain)
- 얼마만큼 추천해 주었을 때 값을 맞았는지 
- DCG : 더 앞쪽에서 추천한 값이 맞은 경우 가중치를 부여하는 알고리즘
- DCG는 추천결과의 위치를 고려할 때 좋은 척도로 보이지만 완벽하지는 않음. 그 이유는 다양한 요인에 따라 권장 사항 수가 사용자마다 다를 수 있는데, DCG는 권장 사항 수에따라 결과가 달라지기 때문
- 그에 따라 상한과 하한이 적절한 점수가 필요하므로 모든 추천 점수를 평균하여 최종 점수를 보고 정규화할 필요가 있음
- 이를 반영한게 NDCG임