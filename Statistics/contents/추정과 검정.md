## 추정과 검정이란,

> <b>검정:  모집단의 모수나 확률 분포에 대해서 가설을 설정하고, 가설에 대한 진실 유무를 확인 하는 것</b>
> <b>추정:  모집단에서 제한된 표본을 추출하여, 역으로 모수의 값을 찾아내는 것. </b>

### 1. 가설 검정
> *  통계적 결정
>  모집단으로부터 추출된 표본에 근거하여, 모집단에 관한 결정을 내리는 것
> 가설을 부정할 때는 기각, 아니면 채택이라는 용어 사용

>  * 귀무가설과 대립가설
> H0: 귀무가설: 일반적으로 가설은 기각되길 바라면서 가설을 세우는데, 이때 가설을 귀무가설
> H1: 대립가설: 귀무가설과 대립되는 가설

> * 검정 통계량
> 귀무가설과 대립가설을 설정하고, 참 거짓을 판단하려고 할 때, 판단 기준이 되는 통계량
> 채택역: 귀무가설을 채택하는 영역, 기각역: 귀무가설을 기각하는 영역

> |                 | H0가 참 | H1이 참 |
> |:--------|:--------:|--------:|
> | H0 채택 | 올바른 결정 | 제2종 오류 |
> | H1 채택 | 제1종 오류 | 올바른 결정 |

> * 단측 검정과 양측 검정
> 단측 검정: 상단측 검정, 하단측 검정

> * 통계적 검정
>  모집단의 모수또는 분포 형태에 대한 추정에 대해  그것이 옳은지 그른지를
> 임의로 추출한 표본으로부터 통계량을 측정하여 판단하는 통계적 절차

> <b> 표본이 크고, 정규성 충족시 </b>
> 단일 모집단의 모평균에 대한 신뢰구간 추정과 검정: <code> t.test() </code>
> ** 일반적으로 T-test는 두 집단의 평균을 비교할 때 사용한다.
> 기본적으로 모 표준편차를 알고 있는 경우는 Z-test를 하는데, 기본적으로
> 모 표준편차를 아는 경우는 극히 드물기 때문에, 기본적으로 T-test를 한다고 알려져 있다.
> 따라서 표본의 개수가 30개 이상일때도, Z-test를 사용하기도 한다. <b>(꼭 알아두기)</b>

> 단일 모집단의 모분산에 대한 신뢰구간 추정과 검정: <code> chisq() </code>
> 단일 모집단의 모비율에 대한 신뢰구간 추정과 검정: <code> prop.test() </code>

> 정규성 미 충족시, 단일 모집단 중심에 대한 비모수 검정: <code> wilcox.test() </code>

> 정규성 여부 검정: <code> shapiro.test(), qqnorm(), qqline() </code>

> * 검정 통계량과 P-value
> 검정 통계량(test statistic): 귀무 가설의 채택 또는 기각 여부를 판단하는데, 사용되는 통계량
> P-value: 귀무가설이 옳다는 가정하에 표본으로부터 계산된 검정 통계량 값을 기준으로
> 대립가설 방향으로의 확률.
> <b> 유의 수준보다 작으면, 귀무가설 기각, 반대면 귀무가설 채택 </b>

> * 단일 모집단의 모평균에 대한 신뢰구간 추정 예시

> 2010년도 고등학교 1학년 남학생의 몸무게를 전수 조사하였더니 평균이 63.0kg, 표준편차가 8.0kg이 나왔다. 2015년에 15명의 남학생을 무작위로 표본을 추출하여 몸무게를 재어보니  
{ 70.2, 54.9, 60.5, 67.0, 63.4, 61.9, 71.8, 66.1, 72.6, 73.0, 68.7, 70.3, 66.2, 55.6, 65.9 }
> 와 같이 나왔을 때, 서울 지역 고등학교 남학생 몸무게가 5년 전보다 더욱 증가 했다고 볼 수 있는가?
> ~~~~
> install.packages("BSDA")    # z-test는 기본 함수로 존재, t-test는 BSDA package 설치 필요
> library(BSDA)             
> x <- c(70.2, 54.9, 67.0, 60.5, 63.4, 61.9, 71.8, 66.1, 72.6, 73.0, 68.7, 70.3, 66.2, 55.6, 56.9)
> z.test(x = x, mu = 63 , sigma.x = 8 , alternative = "two.sided",  conf.level =  0.95 )
> z-test 결과, 귀무가설 채택
>t.test(x = x, alternative = c("greater"), mu = 63, conf.level = 0.95)
>p_value <- (mean(x)- 63) / (8/ sqrt(length(x))) # 실제 검정 통계량 check.

### 2. 모평균에 대한 가설 검정
>  모평균에 대한 가설 검정은 표본평균을 사용
> * <b>가설 검정 단계</b>
> 1. 귀무가설과 대립가설 설정
> --> H0, H1에 대한 범위 설정
> 2. 유의 수준 결정
> --> 0.05, 0.01 등 confidence level 설정
> 3. 검정 통계량 선택
> --> Z, T에 대한 통계량 선택
> 모분산을 아는 경우, 검정 통계량 Z 사용,
> 모분산을 모르는 경우, 검정 통계량 T 사용,
> 4. 기각역 계산
> 기각역에 대한 값(검정 통계량) 계산. 실제로는 1.96  과 같은 값으로 외우고 있음
> 5. 유의성 판정 및 결과의 해석

### 3. 이 표본(Two sample)의 모평균에 대한 t-검정

> * 독립적 두집단 간 VS 대응 비교

> 독립적 두집단 간: ex) 변속기 유형에 따라 연비가 다른지에 대한 검정
> 대응 비교: ex) 같은 대상 10명에 대해 수면제 효과기 있는지에 대한 검정

> * 독립적 두집단 간 예제
> mtcars 자료에서 변속기 유형에 따라 연비가 다른지에 대한 검정
> ~~~
> data(mtcars)
> str(mtcars)
> boxplot(mpg~am, mtcars) # am(변속기의 형태 0, 1) 에 따른 mpg의 boxplot check
> t.test(mpg~factor(am), mtcars) # p-value 값이 0.01보다 훨씬 작으므로, 변속기의 형태에 따라 연비는 다름
>   ~~~

> * 대응 비교 예제
> sleep data: 두 종류의 수면제의 효과를 측정한 자료.
> 두 종류의 수면제의 효과가 증가했는지의 여부 검정
> ~~~
> data(sleep)
> str(sleep)
> boxplot(extra~group, sleep)
> t.test(extra~group, paired = T, sleep) # 1퍼센트 기준에서 두 종류의 수면제의 효과가 유의함을 알 수 있다.
>   ~~~

>  <b> 대응 비교는 대응되는 자료 간의 차이 자료(differenced data)를 일 표본자료로 취급하므로,  </b>
>  <b> 본질적으로 일 표본자료와 같다. </b>
> ~~~
> sleep_d <- with(sleep, extra[group==2] - extra[group==1])
> t.test(sleep_d) # H0: Mean =0 / H1: mean != 0
>   ~~~


> * <b> 대응 표본 T 검정을 하기 위한 확인 절차 3가지 </b>
> [링크 참조](http://blog.naver.com/PostView.nhn?blogId=istech7&logNo=50151133528)

### 4. 모분산에 대한 가설 검정

>  모평균을 아는 경우, 모분산의 가설 검정

> 분산은 제곱 형태를 띄고 있기 때문에, 카이제곱분포를 따른다!**
> 모평균을 알고 있을 때, 다음과 같은 X^2 통계량은 <b>자유도가 n인</b> X^2 분포를 따름

>![equation](https://latex.codecogs.com/gif.latex?%5Cchi%20%5E%7B2%7D%20%3D%20%5Csum_%7Bi%20%3D%201%7D%5E%7Bn%7D%20%5Cfrac%7B%28x_%7Bi%7D-%5Cmu%20%29%5E2%7D%7B%5Csigma%20%5E%7B2%7D%7D)

> 모평균을 모르는 경우 모분산의 가설 검정

> 모평균을 모를 때, 다음과 같은 X^2 통계량은 <b>자유도가 n-1인</b> X^2 분포를 따름

>![equation](https://latex.codecogs.com/gif.latex?%5Cchi%20%5E%7B2%7D%20%3D%20%5Csum_%7Bi%20%3D%201%7D%5E%7Bn%7D%20%5Cfrac%7B%28n-1%20%29S%5E%7B2%7D%7D%7B%5Csigma%20%5E%7B2%7D%7D)

* 모분산 추, 검정 특성

> 제조업에서 품질을 평가하거나, 금융업에서 Risk를 평가할 때 많이 사용하는 것이 퍼짐 정도를 나타내는 분산.
> 단일 모집단의 모비율 추정과 검정에 '카이제곱 분포 통계량' 사용

> V 통계량(X^2)에서 (S^2) /(sigma^2) 의 부분을 보면, 모분산 대비 표본분산이 커지거나 작아지면, 1에 작아진다는 것을 확인 가능

>  T분포와 정규 분포와는 달리, 카이제곱 분포는 대칭형태가 아니기 때문에, 상한 하한 값을 각자 구해야 함

> 제곱 형태이기 때문에, 정규성 가정에 더 민감하게 반응 -> 반드시 check
