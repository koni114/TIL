** 조건부 확률과 전확률정리 (Conditioning Continued, Law of Total Probability)
조건부 확률을 좀 더 깊게 다룰텐데, 단순히 확률에 그치는 것이 아닌
그 생각을 다뤄보자!

*  조건부 확률에 대한 생각.
확률은 불확실과 무작위를 다루는 방법.
실제로 확률에서의 정의(수학식)는 양변에 무언가를 곱하고.. 등을 통해서
쉽게 나타낼 수 있었지만 그걸 어떻게 생각할지,  어떻게 적용할지는 어렵다!
그에 맞춰 추가로 몇개의 정리를 살펴보자.

조건부로 생각하는 것이 이 과목에서 가장 큰 테마.
조건부 확률을 사용하고 조건부로 생각하는 것.
-> 생각하는 조건.
"Thinking conditionally is a condition for thinking."

How to solve a problem?
(1) try simple and extreme cases.
   앞선 시간에서 배웠던 것.

(2) 작은 조각으로 나누자. 더 잘게 쪼개서 최종적으로 바라는 문제를 해결하는 것.
	밴다이어그램을 생각해보자.
	표본 공간 S가 있고, 안에 굉장히 복잡한(ex) 단순 원, 사각형이아닌) 사건 B가 있고
	이를 구해야한다고 생각해보자.
	이를 구하기 위해 공간 S를 쪼갠다고 생각해보자.
	그렇게 생각하면 다음과 같은 식으로 생각할 수 있다. 이는 확률의 공리에서 가져온 것이므로, 증명할 필요가 없다.
	P(B) = P(BnA1 ) + .... + P(B n An) 
	
	다음과 같은 식을, 조건부 확률을 이용해서 다시 나타낼 수 있는데,
	P(B) = P(B|A1)*P(A1) + .... + P(B|An)*P(An)
	
	이 식은 전체 확률의 법칙(law of total prob)이라고 부름.
	이 식이 유용할지는 어떻게 쪼개는지가 매우 중요해짐. 따라서 통계학은 과학이면서 예술!
	
* 조건부 확률이 중요한 이유
1. 그 자체로 중요하다(직관적으로).
2. 비조건부 확률이 필요하더라도 작은 조각들로 쪼개기 위해서는 조건부 확률이 필요하다는 것.

이러한 개념을 토대로 예제를 살펴보자.

** 조건부 확률 예제

1. 예제1
일반적인 카드 2장이 있음. 2장을 손에 들고
52장의 카드 중에 임의로 2장을 뽑음.
2가지의 조건부 확률을 계산해 볼 것임.

1. 1개의 A를 가지고 있을 때, 다른 하나의 카드도 A일 확률.
2. 1개의 스페이드 A를 가지고 있을 때, 다른 하나의 카드도 A일 확률.
두 개를 먼저 확률로 계산해보자.

1번 
P(두개다 A카드를 가지고 있을 확률 n 첫 번째 카드가 A일 확률) / P(첫번째 카드가 A일 확률) 인데,
두 개다 A카드일 경우에 첫 번째 카드가 A일 확률이 부분집합으로 포함되어 있으므로,
= P(두개 다 A카드를 가지고 있을 확률) / P(첫 번째 카드가 A일 확률)
= (4C2 / 52C2) / (1 - (48C2 / 52C2))
= 1 / 33

2번
P(두개 다 A카드를 가지고 있을 확률) / P(첫 번째 카드가 스페이드 A일 확률) 
= P(스페이드 A를 제외한 카드 중 카드를 뽑을 때 A를 뽑을 확률)
= 3 / 51
= 1/ 17

그렇다면 2번의 확률이 1번 확률보다 큰 이유는 뭘까?
단지 조건이 "A를 가지고 있는 확률" -> "스페이드 A를 가지고 있는 확률" 인데 말이다.

직관적인 해석을 위해서 한 번 생각해보자.
힌트를 하나 주자면, A를 가지고 있다는 것은 최소한 하나를 가지고 있다는 말.
반면에 스페이드 A를 가지고 있는 것은 그냥 가지고 있는 것이다.
즉, 말하는 카드가 최소한 하나인지, 특정한 하나인지 오는 차이이다.

* 일상 생활에서의 예
질병 검사.
무엇을 구하고자 하는지 명확히 할 필요성이 있음.
-> 명확한 표기 방법, 무엇의 확률?, 어떤 조건?..등

이 질병은 인구의 1%가 앓는다고 해보자.
1%는 연령이 같다거나 인구통계학적으로 비슷할지도 모름.

질병 검사는 95% 확률로 정확하다.
95% 확률로 정확하다고 하는 것은 모호하기 때문에 몇가지 가정이 필요.

(사건을 정의하려고 할 때는 정확하게 기술하는 것이 중요)
P(D) : 환자가 실제 그 질병을 가질 사건의 확률.
P(T) : 그 환자의 검사 결과 양성 반응을 나타낸 사건의 확률.

95% 확률로 정확하다고 하는 것은, P(T | D) : 0.95 또는 P(T^c | D^c ) : 0.95
즉, 환자가 질병을 가지고 있을 때 95% 확률로 양성판정을 하고(P(T | D)
    환자가 질병을 가지고 있지 않을 때 95% 확률로 음성판정을 한다는 의미(P(T^c|D^c)

하지만, 환자가 알고 싶은 것은 이러한 것이 아니다.
환자는 본인이 질병을 가지고 있는지, 아닌지가 알고 싶을 것임.
즉 환자는 P(D | T) 를 알고 싶어 할 것임.
   -> 우리의 목표.

* 통계학을 실생활에 적용할 때, 잦은 실수 중에 하나는 P(D | T) 와 P(T | D)를 혼동한다는 것.(나도 혼동스럽다.. )
이 둘은 완전히 다른 개념. 이를 베이즈 정리를 통해 어떻게 다른지 유도할 수 있다.
즉,
P(D | T) = P(D) *P(T | D) / P(T) 임을 알고 있다.

우리는 P(D) = 0.01, P(T | D) = 0.95 임을 알고 있고, P(T)는 모르기때문에,
P(T)를 약간 변형하면(전확률의 법칙을 이용)
P(T) = P(T|D)P(D) + P(T|D^c)P(D^c) 로 나타낼 수 있다. 계산하기 더 좋은 구조로 변경된 것이다.
(이때 P(T|D^c) 는 P(T^c | D^c) 가 0.95 이기 때문에 여사건으로 생각하면 됨)

결과적으로 값을 전부 집어 넣으면, 0.16 이 나온다.
뭔가 이상하지 않는가? 
직관적으로 생각하면 양성판정을 받았을 때, 질병을 가지고 있을 확률은 16%이라는 것.
하버드 의사 60명에게 질문을 했는데 대부분 90%에 육박할 것이다라고 예측했음.

이 문제의 교훈은 무엇일까?
첫 번째는 첫 번째 검사와 두 번째 검사가 독립이 아닐 것이다라고 하는 것.

두 번쨰는 직관과 다르다는 것이다. 
왜 직관과 다르게 나오는 것일까? 핵심은 질병 발생율이 1%에 있다.
즉, 검사가 틀리는 경우도 드물지만, 질병을 가지고 있을 확률도 드물다는 것이다.

일종의 경쟁인 것이다.
질병이 더 드물지, 검사가 틀리는 경우가 더 드물지,
대부분의 사람들은 검사가 틀리는 것에 집중한다(나도 그렇게 생각했었다..)

더 쉽게 이해하기 위해, 빈도학파 문제처럼 접근해보자.
같은 실험을 계속해서 반복하는 것이다
1000명의 환자가 있다고 가정해보면, 질병이 있는 환자는 10명정도 있을 것이다.
반면에 990명은 질병이 없는데, 그 중에서 잘못 측정되어 질병이 있다고 판단되는 환자는
990 * 0.05 = 약 50명정도 있다는 것이다!
따라서 10 : 50 -> 약 1:5 정도 이므로 0.16 이라는 확률이 나오는 것이다. 
(WOW)

** 베이즈 정리에 대한 한 가지 중요하고 아름다운 사실.
일관성의 원리를 지닌다는 것.

하나가 아닌 두 조각의 정보를 손에 넣었다고 할 때,
베이즈 정리에 두 사건의 교사건을 이용하여 갱신하거나,
한 정보를 얻고, 점심식사를 하고 난 뒤에 두 번째의 정보를 얻은 경우가 있을 때,

어떠한 방법으로 정보를 갱신하든지 항상 동일한 결과를 얻을 것이다

** 조건부 확률에서 자주 저지르는 실수 예제.
(1) P(A | B) 와 P(B | A)를 혼동하는 실수.
->  검사의 오류(presecutor's error)라고 함.
ex) 샐리 클락 사건.
샐리 클락이라는 엄마의 두 아이가 죽게 되는데, 결과적으로 샐리 클락은 유죄를 판결받는다.
검사가 주장하길, 두 아이가 뚜렷한 이유 없이 그냥 죽는 확률이 1/8300 이라고 말한다.
따라서 두 아이가 죽었으므로, (1/8300) * (1/8300) 이라고 주장한다.

알다시피, 이는 이미 틀렸다. 두 아이가 죽을 확률이 독립적이다라는 것은 틀린 주장이다.
두 번째로는 가정 자체가 잘못됐다는 것이다.
우리가 알아야 할 것은 P(결백함 | 증거) 이지, 그 반대가 아니라는 것이다. 위의 식은 P(증거 | 결백함) 이다.

(2) 사전과 사후의 의미의 혼동.
P(A) 이라고 하는 것은 "prior"임. 즉 정보를 가지기 전이라는 의미
P(A | B) 이라고 하는 것은 "posterior" 임. 즉 정보를 가지고 난 후라는 의미.

간혹가다 문제에서 A가 일어난 후라고 했을 때, P(A) = 1라고 적는 경우가 있음.
P(A) 는 "사전"확률 이므로, P(A) = 1는 완전히 틀린 것이고, P(A | A) = 1이라는 의미.
따라서 조건부 확률에서 왼쪽 | 오른쪽에 뭐가 올지를 잘 생각하는 것이 중요.

(3) 독립과 조건부 독립을 혼동.
- 먼저 조건부 독립이 뭔지 생각해보자.
말 그대로, 어떤 조건일때, 일어나는 두 사건이 독립이다라는 것을 의미한다.
P(A, B | C) = P(A | C) * P(B | C) 라는 식이 성립한다.

- 조건부 독립 일 때, 비조건부 독립이 성립할 것인가? 
결과적으로는 NO.

하나의 반례를 보자면,
두 사람이 체스를 둘 때, 각 사람의 등급이라든지 아무런 정보가 없다고 해보자. 
그 동일한 사람과 체스 몇 판을 둔다고 해보자. 
그 사람 실력 하에서 모든 경기는 독립적(조건부 독립) 이라고 가정하자. 
하지만 비조건부 독립이지는 않는다. 
쉽게 말하면, 내가 3판을 모두 이기고 4번째판에서 누가 이길지를 판별할 때, 앞 선 3번의 판에서의 정보를
토대로 더 쉽게 판단할 수 있다는 것이다. -> 즉 체스를 두는 행위에서 시합을 하면 할 수록
누가더 이길 지 알게 되는 것이므로 독립하지 않는다는 의미!
여기서의 조건부 독립이라고 하는 것은 상대의 실력이 주어졌을때의 조건부 독립을 말한다.

- 독립 조건일 때 조건부 독립이 성립할 것인가? 
결과적으로는 NO.
Ex)  A : 화재 경보기가 울리는 사건
화재 경보기는 다음과 같이 2가지 경우에만 울린다고 가정할 때, 
F : 불이 실제로 난 경우, 
C : 팝콘을 튀긴 경우, 

라고 할 때, F,C는 독립이라고 가정해보자.
이때, 화재 경보가 울리고 있고 아무도 팝콘은 튀기지 않았다고 했을 때의 확률은(P(F | A,C^c)) 1이다.
즉 이들은 독립이지만, 화재 경보가 울렸다는 조건이 주어졌을 때 독립이 아니다 라는 것을 의미!


 

 
































 






